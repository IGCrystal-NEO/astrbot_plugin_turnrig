#!/usr/bin/env python3
"""
éº¦å’ªçš„æ•°å­—å åœè„šæœ¬ ğŸ”®
æ¯å°æ—¶ä¸ºé¡¹ç›®å¸¦æ¥æ–°çš„è¿åŠ¿å–µï½
"""

import datetime
import hashlib
import random


def get_seed():
    """åŸºäºå½“å‰å°æ—¶ç”Ÿæˆç§å­ï¼Œç¡®ä¿åŒä¸€å°æ—¶å†…ç»“æœä¸€è‡´ (ä½¿ç”¨UTC+8æ—¶åŒº)"""
    # ä½¿ç”¨UTCæ—¶é—´åŠ 8å°æ—¶å¾—åˆ°åŒ—äº¬æ—¶é—´
    now = datetime.datetime.utcnow() + datetime.timedelta(hours=8)
    
    # ä½¿ç”¨å¹´æœˆæ—¥å°æ—¶ä½œä¸ºç§å­ï¼Œç¡®ä¿æ¯å°æ—¶æ›´æ–°
    seed_str = f"{now.year}{now.month:02d}{now.day:02d}{now.hour:02d}"
    return int(hashlib.md5(seed_str.encode()).hexdigest()[:8], 16)

def get_fortune():
    """è·å–å½“å‰æ—¶åˆ»çš„è¿åŠ¿"""
    seed = get_seed()
    random.seed(seed)

    # è¿åŠ¿ç­‰çº§
    fortune_levels = [
        "ğŸŒŸ è¶…çº§å¹¸è¿",
        "âœ¨ éå¸¸å¹¸è¿",
        "ğŸ€ æ¯”è¾ƒå¹¸è¿",
        "ğŸ˜Š å°å¹¸è¿",
        "ğŸ˜ å¹³å¹³æ— å¥‡",
        "ğŸ˜… éœ€è¦åŠ æ²¹",
        "ğŸ¤” è¦å°å¿ƒå–µ"
    ]

    # å¹¸è¿æ•°å­— (1-99)
    lucky_number = random.randint(1, 99)

    # å¹¸è¿é¢œè‰²
    lucky_colors = [
        "ğŸ’™ è“è‰²", "ğŸ’š ç»¿è‰²", "ğŸ’œ ç´«è‰²", "â¤ï¸ çº¢è‰²",
        "ğŸ’› é»„è‰²", "ğŸ§¡ æ©™è‰²", "ğŸ¤ ç™½è‰²", "ğŸ–¤ é»‘è‰²",
        "ğŸ’— ç²‰è‰²", "ğŸ¤ æ£•è‰²", "ğŸ’ é“¶è‰²", "âœ¨ é‡‘è‰²"
    ]

    # ä»Šæ—¥å»ºè®®
    daily_tips = [
        "ä»Šå¤©é€‚åˆå†™ä»£ç å–µï½è®°å¾—å¤šå–æ°´å“¦",
        "ä»Šå¤©æ˜¯ä¿®å¤bugçš„å¥½æ—¥å­å–µï½",
        "é€‚åˆå­¦ä¹ æ–°æŠ€æœ¯çš„ä¸€å¤©å–µï½",
        "ä»Šå¤©è¦è®°å¾—ä¼‘æ¯ï¼Œä¸è¦ç†¬å¤œå–µï½",
        "é€‚åˆæ•´ç†ä»£ç å’Œæ–‡æ¡£çš„æ—¥å­å–µï½",
        "ä»Šå¤©å¯èƒ½ä¼šæœ‰æ„å¤–çš„æ”¶è·å–µï½",
        "è®°å¾—å¤‡ä»½é‡è¦æ•°æ®å–µï½",
        "ä»Šå¤©é€‚åˆå’Œæœ‹å‹äº¤æµæŠ€æœ¯å–µï½",
        "ä¿æŒå¥½å¿ƒæƒ…ï¼Œbugéƒ½ä¼šè¿åˆƒè€Œè§£å–µï½",
        "ä»Šå¤©çš„çµæ„Ÿç‰¹åˆ«å¤šï¼Œå¿«å»åˆ›é€ å§å–µï½",
        "é€‚åˆé‡æ„ä»£ç çš„ä¸€å¤©å–µï½",
        "è®°å¾—å…³æ³¨é¡¹ç›®çš„staræ•°å–µï½"
    ]

    # ç‰¹æ®Šäº‹ä»¶ (ä½æ¦‚ç‡)
    special_events = [
        "ğŸ‰ ä»Šå¤©å¯èƒ½ä¼šæœ‰ç‰¹åˆ«çš„å¥½æ¶ˆæ¯å–µï½",
        "ğŸŒˆ ä»Šå¤©æ˜¯å……æ»¡å½©è™¹èˆ¬ç¾å¥½çš„ä¸€å¤©å–µï½",
        "ğŸŠ ä»Šå¤©é€‚åˆåº†ç¥å°æˆå°±å–µï½",
        "ğŸ”¥ ä»Šå¤©çš„å·¥ä½œæ•ˆç‡ä¼šç‰¹åˆ«é«˜å–µï½",
        "ğŸ’« ä»Šå¤©å¯èƒ½ä¼šé‡åˆ°è´µäººç›¸åŠ©å–µï½"
    ]

    level = random.choice(fortune_levels)
    color = random.choice(lucky_colors)
    tip = random.choice(daily_tips)

    # 15%æ¦‚ç‡è§¦å‘ç‰¹æ®Šäº‹ä»¶
    special = random.choice(special_events) if random.random() < 0.15 else None    # ç”Ÿæˆæ—¶é—´æˆ³ (ä½¿ç”¨UTC+8æ—¶åŒº)
    now = datetime.datetime.utcnow() + datetime.timedelta(hours=8)
    timestamp = now.strftime("%Y-%m-%d %H:%M CST")

    # æ ¼å¼åŒ–è¾“å‡º
    fortune_text = f"""## ğŸ”® éº¦å’ªçš„æ•°å­—å åœ ({timestamp})

**{level}** âœ¨

ğŸ¯ **å¹¸è¿æ•°å­—**: {lucky_number}
ğŸ¨ **å¹¸è¿é¢œè‰²**: {color}
ğŸ’¡ **ä»Šæ—¥å»ºè®®**: {tip}"""

    if special:
        fortune_text += f"\nğŸŒŸ **ç‰¹æ®Šé¢„è¨€**: {special}"

    fortune_text += "\n\n*æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡ï¼Œä»…ä¾›å¨±ä¹å–µï½* ğŸ±"

    return fortune_text

if __name__ == "__main__":
    print(get_fortune())
